<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pufi Coin - Earn Crypto</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* General Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 430px;
            width: 100%;
            background-color: #1a1a2e;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            padding-bottom: 80px;
            border-radius: 25px;
            overflow: hidden;
            border: 4px solid #16213e;
        }

        /* Header */
        .header {
            background-color: #16213e;
            color: #fff;
            padding: 20px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 500;
            font-size: 1.2em;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }

        .header span {
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .header span:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }
        
        /* Balance Section */
        .balance {
            background: linear-gradient(45deg, #6a11cb 0%, #2575fc 100%);
            padding: 25px 15px;
            text-align: center;
            color: white;
            margin: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .balance h2 {
            font-size: 1.3em;
            margin-bottom: 5px;
            font-weight: 400;
        }

        .balance-amount {
            font-size: 2.8em;
            font-weight: 700;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        .content {
            padding: 20px 15px;
            color: #e0e0e0;
        }

        /* Section Title */
        .section-title {
            font-size: 1.6em;
            margin-bottom: 25px;
            color: #00ffcc;
            font-weight: 700;
            text-align: center;
            position: relative;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: #00ffcc;
            border-radius: 5px;
        }

        /* Buttons */
        .btn {
            display: block;
            width: 100%;
            padding: 18px;
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.2em;
            font-weight: 700;
            margin: 25px 0;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(38, 117, 252, 0.4);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(38, 117, 252, 0.5);
        }

        .btn:disabled {
            background: #4a455a;
            color: #888;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Ad Card */
        .ad-container {
            background-color: #16213e;
            border: 2px dashed #00ffcc;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            color: #e0e0e0;
        }
        
        .ad-container p {
            color: #fff;
            font-weight: 500;
        }

        .task-item {
            background-color: #16213e;
            padding: 15px;
            border-radius: 15px;
            margin: 15px 0;
            font-size: 0.9em;
            line-height: 1.6;
            color: #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .task-info strong, .task-reward {
            color: #00ffcc;
            text-shadow: 1px 1px 0 #000;
        }

        .task-info p {
            color: #e0e0e0;
        }
        
        .clear-instruction {
            background-color: #16213e;
            padding: 15px;
            border-radius: 15px;
            margin: 15px 0;
            font-size: 0.9em;
            line-height: 1.6;
            color: #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .input-field {
            width: 100%;
            padding: 15px;
            margin: 12px 0;
            border: 2px solid #2575fc;
            border-radius: 15px;
            font-size: 1em;
            background-color: #16213e;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
            color: #fff;
        }
        
        .input-field::placeholder {
            color: #aaa;
        }

        .payment-method {
            background-color: #16213e;
            border-radius: 12px;
            margin: 10px 0;
            padding: 15px;
            transition: all 0.2s ease;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .payment-method:hover {
            transform: translateX(5px);
            background-color: #1a1a2e;
        }

        .payment-method input[type="radio"] {
            accent-color: #2575fc; 
        }

        .payment-method label {
            font-weight: 500;
            color: #e0e0e0;
        }

        .warning-message {
            color: white;
            background-color: #dc3545;
            border: 2px solid #f5c6cb;
            padding: 15px;
            border-radius: 15px;
            margin-top: 20px;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .withdrawal-status {
            margin-top: 30px;
            padding: 20px;
            background-color: #007bff;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.2);
        }

        .withdrawal-status h3 {
            color: #fff;
            font-weight: 700;
        }

        .withdrawal-status p {
            color: #e0e0e0;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .screen.active {
            display: block;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 25px;
        }

        .stat-card {
            background-color: #16213e;
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            color: #e0e0e0;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #00ffcc;
            margin: 8px 0;
            line-height: 1;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.1);
        }

        .stat-card p {
            font-size: 1em;
            color: #ccc;
            font-weight: 500;
        }
        
        /* Navigation Bar */
        .nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 430px;
            display: flex;
            justify-content: space-around;
            background-color: #16213e;
            padding: 10px 0;
            border-top: 2px solid #1a1a2e;
            z-index: 1000;
            box-shadow: 0 -8px 20px rgba(0,0,0,0.2);
            border-radius: 25px 25px 0 0;
        }

        .nav-item {
            text-align: center;
            color: #999;
            font-size: 0.8em;
            font-weight: 500;
            padding: 10px 12px;
            border-radius: 12px;
            min-width: 60px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .nav-item div {
            margin-top: 5px;
        }

        .nav-item svg {
            stroke-width: 2;
            width: 22px;
            height: 22px;
        }

        .nav-item.active {
            color: #00ffcc;
            background-color: #0f3460;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transform: translateY(-5px) scale(1.1);
        }

        .nav-item:hover {
            color: #00ffcc;
            transform: translateY(-3px);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Interstitial Ad Styling */
        .interstitial {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        .interstitial-content {
            max-width: 90%;
            background: rgba(26, 26, 46, 0.8);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .interstitial h2 {
            color: #00ffcc;
            margin-bottom: 20px;
            font-size: 2em;
        }
        
        .interstitial p {
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .countdown {
            font-size: 3em;
            color: #00ffcc;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .coin-animation {
            font-size: 4em;
            margin: 20px 0;
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #16213e;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            width: 0%;
            transition: width 0.1s linear;
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <div id="home-screen" class="screen active">
            <div class="header">
                <span>Close</span>
                <span>Pufi Coin</span>
                <span>Menu</span>
            </div>
            <div class="balance">
                <h2>Balance</h2>
                <div class="balance-amount" id="balance">0 Pufi</div>
            </div>
            <div class="content">
                <h2 class="section-title">Welcome to Pufi Coin</h2>
                <div class="clear-instruction">
                    <p>Earn Pufi Coins by watching ads. Each coin is worth $0.01. Convert 500 coins to USDT and withdraw!</p>
                </div>
                <div class="task-item">
                    <div class="task-info"><strong>Daily Ads</strong><p>Completed</p></div>
                    <div class="task-reward" id="daily-tasks">0/50</div>
                </div>
                <div class="task-item">
                    <div class="task-info"><strong>Hourly Ads</strong><p>Completed</p></div>
                    <div class="task-reward" id="hourly-tasks">0/25</div>
                </div>
                <div class="task-item">
                    <div class="task-info"><strong>Total Earnings</strong></div>
                    <div class="task-reward" id="total-earnings">0 Pufi</div>
                </div>
                <button class="btn" onclick="showAd()" id="task-btn">Watch Ad (+10 Pufi)</button>
                <div id="ad-timer" style="text-align: center; margin-top: 10px; color: #00ffcc; display: none;">
                    Next ad in: <span id="countdown">8</span> seconds
                </div>
            </div>
        </div>
        
        <div id="convert-screen" class="screen">
            <div class="header">
                <span onclick="showScreen('home-screen')">Back</span>
                <span>Convert Coins</span>
                <span>Menu</span>
            </div>
            <div class="balance">
                <h2>Balance</h2>
                <div class="balance-amount" id="convert-balance">0 Pufi</div>
            </div>
            <div class="content">
                <h2 class="section-title">Convert Pufi to USDT</h2>
                <div class="clear-instruction">
                    <p>Convert your Pufi Coins to USDT. Minimum 500 coins required for conversion.</p>
                    <p>Exchange rate: 1 Pufi = $0.01 USDT</p>
                </div>
                <div class="task-item">
                    <div class="task-info"><strong>Available Pufi</strong></div>
                    <div class="task-reward" id="available-pufi">0</div>
                </div>
                <div class="task-item">
                    <div class="task-info"><strong>Available USDT</strong></div>
                    <div class="task-reward" id="available-usdt">0</div>
                </div>
                <h3 style="margin-top: 20px; color: #00ffcc;">Amount to Convert</h3>
                <input type="number" class="input-field" id="convert-amount" placeholder="Enter amount (min 500)">
                <button class="btn" onclick="convertCoins()" id="convert-btn">Convert to USDT</button>
                <div id="convert-status" style="text-align: center; margin-top: 15px; color: #00ffcc; display: none;">
                    Conversion successful!
                </div>
            </div>
        </div>
        
        <div id="withdraw-screen" class="screen">
            <div class="header">
                <span onclick="showScreen('home-screen')">Back</span>
                <span>Withdraw</span>
                <span>Menu</span>
            </div>
            <div class="balance">
                <h2>Balance</h2>
                <div class="balance-amount" id="withdraw-balance">0 USDT</div>
            </div>
            <div class="content">
                <h2 class="section-title">Withdraw Funds</h2>
                <div class="clear-instruction">
                    <p>Withdraw your USDT to your preferred wallet. Minimum withdrawal is $30 (3000 Pufi equivalent).</p>
                    <p>You need 8 referrals to withdraw.</p>
                </div>
                <div class="warning-message" id="referral-warning" style="display: none;">
                    You need 8 referrals to withdraw.
                </div>
                <h3 style="margin-top: 20px; color: #00ffcc;">Amount (USDT)</h3>
                <input type="number" class="input-field" id="withdraw-amount" placeholder="Enter amount">
                <p style="font-size: 0.9em; color: #e0e0e0;">Minimum: 30 USDT</p>
                <h3 style="margin-top: 20px; color: #00ffcc;">Withdrawal Address</h3>
                <input type="text" class="input-field" id="withdraw-address" placeholder="Enter USDT or TON wallet address">
                <p style="font-size: 0.9em; color: #e0e0e0;">Enter your wallet address for selected payment method.</p>
                <h3 style="margin-top: 20px; color: #00ffcc;">Payment Method</h3>
                <div class="payment-method">
                    <input type="radio" name="payment" id="usdt" checked>
                    <label for="usdt">USDT</label>
                </div>
                <div class="payment-method">
                    <input type="radio" name="payment" id="ton">
                    <label for="ton">TON</label>
                </div>
                <button class="btn" onclick="requestWithdrawal()">Request Withdrawal</button>
                <div id="withdrawal-status" class="withdrawal-status" style="display: none;">
                    <h3>Withdrawal Request Submitted!</h3>
                    <p id="status-message"></p>
                    <p style="margin-top: 10px; font-size: 0.9em; color: #e0e0e0;">Your payment will be processed shortly.</p>
                </div>
            </div>
        </div>
        
        <div id="tg-screen" class="screen">
            <div class="header">
                <span onclick="showScreen('home-screen')">Back</span>
                <span>Telegram Task</span>
                <span>Menu</span>
            </div>
            <div class="balance">
                <h2>Balance</h2>
                <div class="balance-amount" id="tg-balance">0 Pufi</div>
            </div>
            <div class="content" style="text-align: center;">
                <h2 class="section-title">Telegram Task</h2>
                <div class="clear-instruction">
                    <p>Join our Telegram channel and get rewards!</p>
                </div>
                <div style="margin-top: 30px;">
                    <p style="font-size: 1.1em; margin-bottom: 10px; color: #fff;">Join our Telegram channel and get 50 Pufi Coins!</p>
                    <button class="btn" onclick="window.open('https://t.me/PUFI83', '_blank')">Join Channel</button>
                    <button class="btn" onclick="verifyTelegram()" id="verify-btn">Verify Join (+50 Pufi)</button>
                </div>
            </div>
        </div>
        
        <div id="profile-screen" class="screen">
            <div class="header">
                <span onclick="showScreen('home-screen')">Back</span>
                <span>Profile</span>
                <span>Menu</span>
            </div>
            <div class="balance">
                <h2>Balance</h2>
                <div class="balance-amount" id="profile-balance">0 Pufi</div>
            </div>
            <div class="content">
                <h2 class="section-title">Pufi Coin</h2>
                <p style="text-align: center; margin-bottom: 25px; font-size: 0.9em; color: #e0e0e0;">Joined on August 22, 2025</p>
                <h2 class="section-title">Your Statistics</h2>
                <div class="clear-instruction">
                    <p>View your earnings and activity statistics.</p>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <p>Total Earned</p>
                        <div class="stat-value" id="total-earned">0</div>
                        <p>Pufi</p>
                    </div>
                    <div class="stat-card">
                        <p>USDT Balance</p>
                        <div class="stat-value" id="usdt-balance">0</div>
                        <p>USDT</p>
                    </div>
                    <div class="stat-card">
                        <p>Tasks Completed</p>
                        <div class="stat-value" id="tasks-done">0</div>
                    </div>
                    <div class="stat-card">
                        <p>Withdrawals</p>
                        <div class="stat-value" id="withdrawals-count">0</div>
                    </div>
                    <div class="stat-card">
                        <p>Referrals</p>
                        <div class="stat-value" id="referrals-count">0</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="nav">
            <div class="nav-item active" onclick="showScreen('home-screen')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                <div>Home</div>
            </div>
            <div class="nav-item" onclick="showScreen('convert-screen')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                <div>Convert</div>
            </div>
            <div class="nav-item" onclick="showScreen('withdraw-screen')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="feather feather-credit-card"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                <div>Withdraw</div>
            </div>
            <div class="nav-item" onclick="showScreen('tg-screen')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                <div>Telegram</div>
            </div>
            <div class="nav-item" onclick="showScreen('profile-screen')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                <div>Profile</div>
            </div>
        </div>
    </div>

    <!-- Interstitial Ad -->
    <div id="interstitial-ad" class="interstitial" style="display: none;">
        <div class="interstitial-content">
            <div class="coin-animation">ðŸª™</div>
            <h2>Earning Pufi Coins!</h2>
            <p>Watch this ad to earn 10 Pufi Coins</p>
            <div class="progress-bar">
                <div class="progress" id="ad-progress"></div>
            </div>
            <div class="countdown" id="ad-countdown">8</div>
            <p>Ad will complete automatically</p>
        </div>
    </div>

    <script data-project-id="1268">
      !function(){
        var s=document.currentScript,p=s.getAttribute('data-project-id')||'default';
        var d=['https://ad.gigapub.tech','https://ru-ad.gigapub.tech'],i=0,t,sc;
        function l(){
          sc=document.createElement('script');
          sc.async=true;
          sc.src=d[i]+'/script?id='+p;
          clearTimeout(t);
          t=setTimeout(function(){
            sc.onload=sc.onerror=null;
            sc.src='';
            if(++i<d.length)l();
          },15000);
          sc.onload=function(){clearTimeout(t)};
          sc.onerror=function(){clearTimeout(t);if(++i<d.length)l()};
          document.head.appendChild(sc);
        }
        l();
      }();
    </script>
    <script>
        let userData = {
            userId: generateUserId(),
            balance: 0,
            usdtBalance: 0,
            dailyAdsCompleted: 0,
            hourlyAdsCompleted: 0,
            totalEarnings: 0,
            tasksDone: 0,
            withdrawals: 0,
            referrals: 0,
            lastAdTime: null,
            telegramVerified: false,
            lastAdDate: null,
            lastAdHour: null,
        };
        
        const DAILY_ADS_LIMIT = 50;
        const HOURLY_ADS_LIMIT = 25;
        const AD_REWARD_AMOUNT = 10;
        const COIN_VALUE = 0.01; // $0.01 per coin
        const MIN_CONVERSION = 500;
        const MIN_WITHDRAWAL = 30; // $30
        const REQUIRED_REFERRALS = 8;
        
        const TELEGRAM_CHANNEL_LINK = "https://t.me/PUFI83";

        function initApp() {
            loadUserData();
            updateAll();
            
            checkAdAvailability();
            updateReferralWarning();
            updateTelegramButton();
        }
        
        function generateUserId() {
            return 'USER' + Math.floor(100000 + Math.random() * 900000);
        }
        
        function loadUserData() {
            try {
                const savedData = localStorage.getItem('pufiCoinUserData');
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    userData = {
                        ...userData,
                        ...parsedData
                    };
                }
            } catch (e) {
                console.error('Error loading user data:', e);
                localStorage.removeItem('pufiCoinUserData');
            }
        }
        
        function saveUserData() {
            try {
                localStorage.setItem('pufiCoinUserData', JSON.stringify(userData));
            } catch (e) {
                console.error('Error saving user data:', e);
            }
        }

        function updateAll() {
            updateBalances();
            updateStats();
            updateTaskCounts();
        }
        
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(div => {
                div.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const navItems = document.querySelectorAll('.nav-item');
            if (screenId === 'home-screen') navItems[0].classList.add('active');
            else if (screenId === 'convert-screen') {
                navItems[1].classList.add('active');
                document.getElementById('available-pufi').textContent = userData.balance;
                document.getElementById('available-usdt').textContent = userData.usdtBalance.toFixed(2);
            }
            else if (screenId === 'withdraw-screen') {
                navItems[2].classList.add('active');
                updateReferralWarning();
                document.getElementById('withdrawal-status').style.display = 'none';
                document.getElementById('withdraw-balance').textContent = userData.usdtBalance.toFixed(2) + " USDT";
            }
            else if (screenId === 'tg-screen') {
                navItems[3].classList.add('active');
                updateTelegramButton();
            }
            else if (screenId === 'profile-screen') navItems[4].classList.add('active');
            
            updateAll();
        }
        
        function updateBalances() {
            document.querySelectorAll('.balance-amount').forEach(el => {
                if (el.id === 'withdraw-balance') {
                    el.textContent = userData.usdtBalance.toFixed(2) + ' USDT';
                } else {
                    el.textContent = userData.balance + ' Pufi';
                }
            });
        }
        
        function updateStats() {
            document.getElementById('total-earned').textContent = userData.totalEarnings;
            document.getElementById('usdt-balance').textContent = userData.usdtBalance.toFixed(2);
            document.getElementById('tasks-done').textContent = userData.tasksDone;
            document.getElementById('withdrawals-count').textContent = userData.withdrawals;
            document.getElementById('referrals-count').textContent = userData.referrals;
        }
        
        function updateTaskCounts() {
            const dailyTasksElement = document.getElementById('daily-tasks');
            const hourlyTasksElement = document.getElementById('hourly-tasks');
            const totalEarningsElement = document.getElementById('total-earnings');

            if (dailyTasksElement) dailyTasksElement.textContent = userData.dailyAdsCompleted + '/' + DAILY_ADS_LIMIT;
            if (hourlyTasksElement) hourlyTasksElement.textContent = userData.hourlyAdsCompleted + '/' + HOURLY_ADS_LIMIT;
            if (totalEarningsElement) totalEarningsElement.textContent = userData.totalEarnings + ' Pufi';
        }
        
        function checkAdAvailability() {
            const now = new Date();
            const taskBtn = document.getElementById('task-btn');
            const adTimer = document.getElementById('ad-timer');
            
            const lastAdDate = userData.lastAdDate ? new Date(userData.lastAdDate) : null;
            const lastAdHour = userData.lastAdHour;
            
            // Reset daily count if it's a new day
            if (!lastAdDate || lastAdDate.toDateString() !== now.toDateString()) {
                userData.dailyAdsCompleted = 0;
            }
            
            // Reset hourly count if it's a new hour
            if (!lastAdHour || lastAdHour !== now.getHours()) {
                userData.hourlyAdsCompleted = 0;
            }
            
            saveUserData();
            updateTaskCounts();
            
            taskBtn.textContent = `Watch Ad (+${AD_REWARD_AMOUNT} Pufi)`;
            taskBtn.disabled = false;
            adTimer.style.display = 'none';

            if (userData.dailyAdsCompleted >= DAILY_ADS_LIMIT) {
                taskBtn.disabled = true;
                taskBtn.textContent = 'Daily limit reached';
                return;
            }
            
            if (userData.hourlyAdsCompleted >= HOURLY_ADS_LIMIT) {
                taskBtn.disabled = true;
                taskBtn.textContent = 'Hourly limit reached';
                return;
            }
            
            // Check if we need to wait before showing next ad
            if (userData.lastAdTime) {
                const lastAd = new Date(userData.lastAdTime);
                const timeDiff = (now - lastAd) / 1000; // in seconds
                
                if (timeDiff < 8) {
                    taskBtn.disabled = true;
                    adTimer.style.display = 'block';
                    const countdownElement = document.getElementById('countdown');
                    let remaining = 8 - Math.floor(timeDiff);
                    
                    countdownElement.textContent = remaining;
                    
                    const countdownInterval = setInterval(() => {
                        remaining--;
                        if (remaining <= 0) {
                            clearInterval(countdownInterval);
                            taskBtn.disabled = false;
                            adTimer.style.display = 'none';
                        } else {
                            countdownElement.textContent = remaining;
                        }
                    }, 1000);
                }
            }
        }
        
        function showAd() {
            const interstitial = document.getElementById('interstitial-ad');
            const adCountdown = document.getElementById('ad-countdown');
            const adProgress = document.getElementById('ad-progress');
            
            // Show interstitial ad
            interstitial.style.display = 'flex';
            
            let timeLeft = 8;
            adCountdown.textContent = timeLeft;
            adProgress.style.width = '0%';
            
            const interval = setInterval(()